library(ggplot2)
library(reshape)
library(reshape2)
install.packages("reshape2")
library(reshape2)
library(scales)
library(ade4)
library(RColorBrewer)
install.packages("vegan")
script_loc = getwd()
script_loc
script_loc = getwd()
setwd("/Users/guillermotorres/Documents/Proyectos/Doctorado/Metagenome_16S/Metagenome/networks/")
script_loc
setwd("/Users/guillermotorres/Documents/Proyectos/Doctorado/Metagenome_16S/Metagenome/Madrid/results/")
files.path = '/Users/guillermotorres/Documents/Proyectos/Doctorado/Metagenome_16S/Metagenome/Madrid/bin/'#
m_wdeg <- read.table(paste(files.path,'OTU_best5p/OTUp_males_best5p_wdegree_st.txt',sep=''),header=T,sep="\t")
f_wdeg <- read.table(paste(files.path,'OTU_best5p/OTUp_females_best5p_wdegree_st.txt',sep=''),header=T,sep="\t")
##################
##* Functionns *##
##################
## Summarizes data.
## Gives count, mean, standard deviation, standard error of the mean, and confidence interval (default 95%).
##   data: a data frame.
##   measurevar: the name of a column that contains the variable to be summariezed
##   groupvars: a vector containing names of columns that contain grouping variables
##   na.rm: a boolean that indicates whether to ignore NA's
##   conf.interval: the percent range of the confidence interval (default is 95%)
summarySE <- function(data=NULL, measurevar, groupvars=NULL, na.rm=FALSE,
conf.interval=.95, .drop=TRUE) {
library(plyr)
# New version of length which can handle NA's: if na.rm==T, don't count them
length2 <- function (x, na.rm=FALSE) {
if (na.rm) sum(!is.na(x))
else       length(x)
}
# This does the summary. For each group's data frame, return a vector with
# N, mean, and sd
datac <- ddply(data, groupvars, .drop=.drop,
.fun = function(xx, col) {
c(N    = length2(xx[[col]], na.rm=na.rm),
mean = mean   (xx[[col]], na.rm=na.rm),
sd   = sd     (xx[[col]], na.rm=na.rm)
)
},
measurevar
)
# Rename the "mean" column
datac <- rename(datac, c("mean" = measurevar))
datac$se <- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean
# Confidence interval multiplier for standard error
# Calculate t-statistic for confidence interval:
# e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1
ciMult <- qt(conf.interval/2 + .5, datac$N-1)
datac$ci <- datac$se * ciMult
return(datac)
}
#################################
#* Networks metrics graphs     *#
#################################
head(m_wdeg[,1:5])
m_wdm <- apply(m_wdeg[2:ncol(m_wdeg)],1,mean)
m_wdegt <- melt(m_wdeg,id.vars=c("X"))
m_wdSE <- summarySE(m_wdegt,measurevar="value",groupvars=c("X"))
m_wdSE$"gender" <- rep("male",NROW(m_wdSE))
f_wdm <- apply(f_wdeg[2:ncol(f_wdeg)],1,mean)
f_wdegt <- melt(f_wdeg,id.vars=c("X"))
f_wdSE <- summarySE(f_wdegt,measurevar="value",groupvars=c("X"))
f_wdSE$"gender" <- rep("female",NROW(f_wdSE))
wdSE <- rbind(m_wdSE,f_wdSE)
ggplot(data=wdSE,aes(X,value,color=gender))+geom_line()+geom_point()+
ylab("Mean of strength")+xlab("Window age mean")+
ggtitle("Strength")+
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=.1)
ggplot(data=wdSE,aes(X,value,color=gender))+geom_line()+geom_point()+
ylab("Mean of strength")+xlab("Window age mean")+
ggtitle("Strength")+
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=.1)
install.packages("ggplot2")
library(ggplot2)
ggplot(data=wdSE,aes(X,value,color=gender))+geom_line()+geom_point()+
ylab("Mean of strength")+xlab("Window age mean")+
ggtitle("Strength")+
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=.1)
df <- m_wdeg
z = data.frame("X"=NULL,"N"=NULL,"P"=NULL,"V"=NULL)
for (i in seq(1,ncol(t(df)))){
x = t(df[i,])
f <- sort(x[2:length(x)],decreasing=T)[1]
fn <- rownames(x)[which(x %in% f)[1]]
s <- sort(x[2:length(x)],decreasing=T)[2]
sn <- rownames(x)[which(x %in% s)[1]]
t <- sort(x[2:length(x)],decreasing=T)[3]
tn <- rownames(x)[which(x %in% t)[1]]
l <- sort(x[2:length(x)],decreasing=F)
l <- l[min( which ( l != 0 )) : max( which( l != 0 ))][1]
ln <- rownames(x)[match(x[grep(l,x)],x)][1]
k = data.frame("X"=rep(x[1],4),"N"=c(fn,sn,tn,ln),"P"=c("F","S","T","L"),"V"=c(f,s,t,l))
z <- rbind(z,k)
}
maxS <- sort(z$V[z$P=="F"],decreasing=T)[1]
maxS <- which(z$V %in% maxS)[1]
z[maxS,1]
minS <- sort(z$V[z$P=="F"],decreasing=F)[1]
maxS <- which(z$V %in% minS)[1]
z[minS,1]
m <- melt(df,id.vars=c("X"))
ggplot(data=m)+geom_line(aes(x=z$X,y=z$V,group=z$P,colour=z$P))+geom_point(aes(x=z$X,y=z$V,colour=z$P),size=1.5)+
ylab("Strength")+xlab("Window age mean")+ggtitle("OTU with highest stremgth")+#scale_y_discrete(labels="")+
scale_colour_discrete(name="Positions",breaks=c("F", "S","T", "L"),labels=c("First","Second","Thirth","Last"))
ggplot(data=m,aes(x=X,y=value,group=variable,colour=variable))+geom_line()+geom_point(size=1.5)+
ylab("Strength")+xlab("Window age mean")+theme(legend.position="none")+ggtitle("Strength by OTU")
OTU <- read.table(paste(files.path,'OTU_best5p/OTUp_females_35.4_best5p.txt',sep=''),header=T,sep="\t")
m <- upper.tri(as.matrix(OTU[2:ncol(OTU)]))
up <- OTU[2:ncol(OTU)][m]
hist(up)
d <- density(up)
plot(d, main="Kernel Density")
polygon(d, col="red", border="blue")
#boxplot(up,pch=20)
max(up)
min(up)
up_x <- sort(up)
up_x <- up_x[min( which ( up_x != 0 )) : max( which( up_x != 0 ))]
d_x <- density(up_x)
plot(d_x, main="Kernel Density")
polygon(d_x, col="red", border="blue")
hist(up)
hist(up_x)
head(up_x)
lenght(up_x)
length(up_x)
ggplot(data=wdSE,aes(X,value,color=gender))+geom_line()+geom_point()+
ylab("Mean of strength")+xlab("Window age mean")+
ggtitle("Strength")+
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=.1)
ggplot(data=wdSE,aes(X,value,color=gender))+geom_line()+geom_point()+
ylab("Mean of strength")+xlab("Window age mean")+
ggtitle("Strength")+
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=.1)
m_wdeg <- read.table(paste(files.path,'OTU_best5p/OTUp_males_best5p_wdegree_st.txt',sep=''),header=T,sep="\t")
f_wdeg <- read.table(paste(files.path,'OTU_best5p/OTUp_females_best5p_wdegree_st.txt',sep=''),header=T,sep="\t")
m_wdm <- apply(m_wdeg[2:ncol(m_wdeg)],1,mean)
m_wdegt <- melt(m_wdeg,id.vars=c("X"))
m_wdSE <- summarySE(m_wdegt,measurevar="value",groupvars=c("X"))
m_wdSE$"gender" <- rep("male",NROW(m_wdSE))
f_wdm <- apply(f_wdeg[2:ncol(f_wdeg)],1,mean)
f_wdegt <- melt(f_wdeg,id.vars=c("X"))
f_wdSE <- summarySE(f_wdegt,measurevar="value",groupvars=c("X"))
f_wdSE$"gender" <- rep("female",NROW(f_wdSE))
wdSE <- rbind(m_wdSE,f_wdSE)
ggplot(data=wdSE,aes(X,value,color=gender))+geom_line()+geom_point()+
ylab("Mean of strength")+xlab("Window age mean")+
ggtitle("Strength")+
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=.1)
dev.off()
ggplot(data=wdSE,aes(X,value,color=gender))+geom_line()+geom_point()+
ylab("Mean of strength")+xlab("Window age mean")+
ggtitle("Strength")+
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=.1)
m_wdeg <- read.table(paste(files.path,'OTU_best5p/OTUp_males_best5p_wdegree.txt',sep=''),header=T,sep="\t")
f_wdeg <- read.table(paste(files.path,'OTU_best5p/OTUp_females_best5p_wdegree.txt',sep=''),header=T,sep="\t")
qplot(x=m_clos$'X',y=m_clos[,4],data=m_clos,geom="line")
qplot(x=f_clos$'X',y=f_clos[,4],data=f_clos,geom="line")
m_clt <- melt(m_clos,id.vars=c("X"))
m_clSE <- summarySE(m_clt,measurevar="value",groupvars=c("X"))
m_clSE$"gender" <- rep("male",NROW(m_clSE))
f_clt <- melt(f_clos,id.vars=c("X"))
head(m_clos[,1:5])
m_wdeg <- read.table(paste(files.path,'OTU_best5p/OTUp_males_best5p_wdegree.txt',sep=''),header=T,sep="\t")
f_wdeg <- read.table(paste(files.path,'OTU_best5p/OTUp_females_best5p_wdegree.txt',sep=''),header=T,sep="\t")
head(m_wdeg[,1:5])
qplot(x=m_wdeg$'X',y=m_wdeg[,4],data=m_wdeg,geom="line")
qplot(x=f_wdeg$'X',y=f_wdeg[,4],data=f_wdeg,geom="line")
m_wdm <- apply(m_wdeg[2:ncol(m_wdeg)],1,mean)
m_wdegt <- melt(m_wdeg,id.vars=c("X"))
m_wdSE <- summarySE(m_wdegt,measurevar="value",groupvars=c("X"))
m_wdSE$"gender" <- rep("male",NROW(m_wdSE))
f_wdm <- apply(f_wdeg[2:ncol(f_wdeg)],1,mean)
f_wdegt <- melt(f_wdeg,id.vars=c("X"))
f_wdSE <- summarySE(f_wdegt,measurevar="value",groupvars=c("X"))
f_wdSE$"gender" <- rep("female",NROW(f_wdSE))
wdSE <- rbind(m_wdSE,f_wdSE)
ggplot(data=wdSE,aes(X,value,color=gender))+geom_line()+geom_point()+
ylab("Mean of strength")+xlab("Window age mean")+
ggtitle("Strength")+
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=.1)
m_wdeg <- read.table(paste(files.path,'OTU_best5p/OTUp_males_best5p_wdegree_st.txt',sep=''),header=T,sep="\t")
f_wdeg <- read.table(paste(files.path,'OTU_best5p/OTUp_females_best5p_wdegree_st.txt',sep=''),header=T,sep="\t")
head(m_wdeg[,1:5])
qplot(x=m_wdeg$'X',y=m_wdeg[,4],data=m_wdeg,geom="line")
qplot(x=f_wdeg$'X',y=f_wdeg[,4],data=f_wdeg,geom="line")
m_wdm <- apply(m_wdeg[2:ncol(m_wdeg)],1,mean)
m_wdegt <- melt(m_wdeg,id.vars=c("X"))
m_wdSE <- summarySE(m_wdegt,measurevar="value",groupvars=c("X"))
m_wdSE$"gender" <- rep("male",NROW(m_wdSE))
f_wdm <- apply(f_wdeg[2:ncol(f_wdeg)],1,mean)
f_wdegt <- melt(f_wdeg,id.vars=c("X"))
f_wdSE <- summarySE(f_wdegt,measurevar="value",groupvars=c("X"))
f_wdSE$"gender" <- rep("female",NROW(f_wdSE))
wdSE <- rbind(m_wdSE,f_wdSE)
ggplot(data=wdSE,aes(X,value,color=gender))+geom_line()+geom_point()+
ylab("Mean of strength")+xlab("Window age mean")+
ggtitle("Strength")+
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=.1)
pdf("Best5p_strength.pdf", pointsize = 12, width = 10 , height = 7 )
ggplot(data=wdSE,aes(X,value,color=gender))+geom_line()+geom_point()+
ylab("Mean of strength")+xlab("Window age mean")+
ggtitle("Strength")+
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=.1)
dev.off()
OTUstGraph <- function (df,sample){
z = data.frame("X"=NULL,"N"=NULL,"P"=NULL,"V"=NULL)
for (i in seq(1,ncol(t(df)))){
x = t(df[i,])
f <- sort(x[2:length(x)],decreasing=T)[1]
fn <- rownames(x)[which(x %in% f)[1]]
s <- sort(x[2:length(x)],decreasing=T)[2]
sn <- rownames(x)[which(x %in% s)[1]]
t <- sort(x[2:length(x)],decreasing=T)[3]
tn <- rownames(x)[which(x %in% t)[1]]
l <- sort(x[2:length(x)],decreasing=F)
l <- l[min( which ( l != 0 )) : max( which( l != 0 ))][1]
ln <- rownames(x)[match(x[grep(l,x)],x)][1]
k = data.frame("X"=rep(x[1],4),"N"=c(fn,sn,tn,ln),"P"=c("F","S","T","L"),"V"=c(f,s,t,l))
z <- rbind(z,k)
}
maxS <- sort(z$V[z$P=="F"],decreasing=T)[1]
maxS <- which(z$V %in% maxS)[1]
z[maxS,1]
minS <- sort(z$V[z$P=="F"],decreasing=F)[1]
maxS <- which(z$V %in% minS)[1]
z[minS,1]
m <- melt(df,id.vars=c("X"))
pdf("Best5p_TopOTUstrenght.pdf", pointsize = 12, width = 10 , height = 7 )
ggplot(data=m)+geom_line(aes(x=z$X,y=z$V,group=z$P,colour=z$P))+geom_point(aes(x=z$X,y=z$V,colour=z$P),size=1.5)+
ylab("Strength")+xlab("Window age mean")+ggtitle(paste(sample," - OTU with highest stremgth",sep=""))+#scale_y_discrete(labels="")+
scale_colour_discrete(name="Positions",breaks=c("F", "S","T", "L"),labels=c("First","Second","Thirth","Last"))
dev.off()
pdf("Best5p_AllOTUstrenght.pdf", pointsize = 12, width = 10 , height = 7 )
ggplot(data=m,aes(x=X,y=value,group=variable,colour=variable))+geom_line()+geom_point(size=1.5)+
ylab("Strength")+xlab("Window age mean")+theme(legend.position="none")+ggtitle(paste(sample," - Strength by OTU",sep=""))
dev.off()
}
OTUstGraph <- function (df,sample){
z = data.frame("X"=NULL,"N"=NULL,"P"=NULL,"V"=NULL)
for (i in seq(1,ncol(t(df)))){
x = t(df[i,])
f <- sort(x[2:length(x)],decreasing=T)[1]
fn <- rownames(x)[which(x %in% f)[1]]
s <- sort(x[2:length(x)],decreasing=T)[2]
sn <- rownames(x)[which(x %in% s)[1]]
t <- sort(x[2:length(x)],decreasing=T)[3]
tn <- rownames(x)[which(x %in% t)[1]]
l <- sort(x[2:length(x)],decreasing=F)
l <- l[min( which ( l != 0 )) : max( which( l != 0 ))][1]
ln <- rownames(x)[match(x[grep(l,x)],x)][1]
k = data.frame("X"=rep(x[1],4),"N"=c(fn,sn,tn,ln),"P"=c("F","S","T","L"),"V"=c(f,s,t,l))
z <- rbind(z,k)
}
maxS <- sort(z$V[z$P=="F"],decreasing=T)[1]
maxS <- which(z$V %in% maxS)[1]
z[maxS,1]
minS <- sort(z$V[z$P=="F"],decreasing=F)[1]
maxS <- which(z$V %in% minS)[1]
z[minS,1]
m <- melt(df,id.vars=c("X"))
pdf(paste("Best5p_TopOTUstrenght",sample,".pdf",sep=""), pointsize = 12, width = 10 , height = 7 )
ggplot(data=m)+geom_line(aes(x=z$X,y=z$V,group=z$P,colour=z$P))+geom_point(aes(x=z$X,y=z$V,colour=z$P),size=1.5)+
ylab("Strength")+xlab("Window age mean")+ggtitle(paste(sample," - OTU with highest stremgth",sep=""))+#scale_y_discrete(labels="")+
scale_colour_discrete(name="Positions",breaks=c("F", "S","T", "L"),labels=c("First","Second","Thirth","Last"))
dev.off()
pdf(paste("Best5p_AllOTUstrenght",sample,".pdf",sep=""), pointsize = 12, width = 10 , height = 7 )
ggplot(data=m,aes(x=X,y=value,group=variable,colour=variable))+geom_line()+geom_point(size=1.5)+
ylab("Strength")+xlab("Window age mean")+theme(legend.position="none")+ggtitle(paste(sample," - Strength by OTU",sep=""))
dev.off()
}
OTUstGraph(m_wdeg)
OTUstGraph(m_wdeg,"Males")
OTUstGraph(m_wdeg,"Females")
df <- m_wdeg
sample <- "Males"
z = data.frame("X"=NULL,"N"=NULL,"P"=NULL,"V"=NULL)
for (i in seq(1,ncol(t(df)))){
x = t(df[i,])
f <- sort(x[2:length(x)],decreasing=T)[1]
fn <- rownames(x)[which(x %in% f)[1]]
s <- sort(x[2:length(x)],decreasing=T)[2]
sn <- rownames(x)[which(x %in% s)[1]]
t <- sort(x[2:length(x)],decreasing=T)[3]
tn <- rownames(x)[which(x %in% t)[1]]
l <- sort(x[2:length(x)],decreasing=F)
l <- l[min( which ( l != 0 )) : max( which( l != 0 ))][1]
ln <- rownames(x)[match(x[grep(l,x)],x)][1]
k = data.frame("X"=rep(x[1],4),"N"=c(fn,sn,tn,ln),"P"=c("F","S","T","L"),"V"=c(f,s,t,l))
z <- rbind(z,k)
}
maxS <- sort(z$V[z$P=="F"],decreasing=T)[1]
maxS <- which(z$V %in% maxS)[1]
z[maxS,1]
minS <- sort(z$V[z$P=="F"],decreasing=F)[1]
maxS <- which(z$V %in% minS)[1]
z[minS,1]
m <- melt(df,id.vars=c("X"))
ggplot(data=m)+geom_line(aes(x=z$X,y=z$V,group=z$P,colour=z$P))+geom_point(aes(x=z$X,y=z$V,colour=z$P),size=1.5)+
ylab("Strength")+xlab("Window age mean")+ggtitle(paste(sample," - OTU with highest stremgth",sep=""))+#scale_y_discrete(labels="")+
scale_colour_discrete(name="Positions",breaks=c("F", "S","T", "L"),labels=c("First","Second","Thirth","Last"))
pdf(paste("Best5p_TopOTUstrenght",sample,".pdf",sep=""), pointsize = 12, width = 10 , height = 7 )
ggplot(data=m)+geom_line(aes(x=z$X,y=z$V,group=z$P,colour=z$P))+geom_point(aes(x=z$X,y=z$V,colour=z$P),size=1.5)+
ylab("Strength")+xlab("Window age mean")+ggtitle(paste(sample," - OTU with highest stremgth",sep=""))+#scale_y_discrete(labels="")+
scale_colour_discrete(name="Positions",breaks=c("F", "S","T", "L"),labels=c("First","Second","Thirth","Last"))
dev.off()
pdf(paste("Best5p_AllOTUstrenght",sample,".pdf",sep=""), pointsize = 12, width = 10 , height = 7 )
ggplot(data=m,aes(x=X,y=value,group=variable,colour=variable))+geom_line()+geom_point(size=1.5)+
ylab("Strength")+xlab("Window age mean")+theme(legend.position="none")+ggtitle(paste(sample," - Strength by OTU",sep=""))
dev.off()
OTUstGraph(f_wdeg,"Females")
df <- f_wdeg
sample <- "Females"
z = data.frame("X"=NULL,"N"=NULL,"P"=NULL,"V"=NULL)
for (i in seq(1,ncol(t(df)))){
x = t(df[i,])
f <- sort(x[2:length(x)],decreasing=T)[1]
fn <- rownames(x)[which(x %in% f)[1]]
s <- sort(x[2:length(x)],decreasing=T)[2]
sn <- rownames(x)[which(x %in% s)[1]]
t <- sort(x[2:length(x)],decreasing=T)[3]
tn <- rownames(x)[which(x %in% t)[1]]
l <- sort(x[2:length(x)],decreasing=F)
l <- l[min( which ( l != 0 )) : max( which( l != 0 ))][1]
ln <- rownames(x)[match(x[grep(l,x)],x)][1]
k = data.frame("X"=rep(x[1],4),"N"=c(fn,sn,tn,ln),"P"=c("F","S","T","L"),"V"=c(f,s,t,l))
z <- rbind(z,k)
}
maxS <- sort(z$V[z$P=="F"],decreasing=T)[1]
maxS <- which(z$V %in% maxS)[1]
z[maxS,1]
minS <- sort(z$V[z$P=="F"],decreasing=F)[1]
maxS <- which(z$V %in% minS)[1]
z[minS,1]
m <- melt(df,id.vars=c("X"))
pdf(paste("Best5p_TopOTUstrenght",sample,".pdf",sep=""), pointsize = 12, width = 10 , height = 7 )
ggplot(data=m)+geom_line(aes(x=z$X,y=z$V,group=z$P,colour=z$P))+geom_point(aes(x=z$X,y=z$V,colour=z$P),size=1.5)+
ylab("Strength")+xlab("Window age mean")+ggtitle(paste(sample," - OTU with highest stremgth",sep=""))+#scale_y_discrete(labels="")+
scale_colour_discrete(name="Positions",breaks=c("F", "S","T", "L"),labels=c("First","Second","Thirth","Last"))
dev.off()
pdf(paste("Best5p_AllOTUstrenght",sample,".pdf",sep=""), pointsize = 12, width = 10 , height = 7 )
ggplot(data=m,aes(x=X,y=value,group=variable,colour=variable))+geom_line()+geom_point(size=1.5)+
ylab("Strength")+xlab("Window age mean")+theme(legend.position="none")+ggtitle(paste(sample," - Strength by OTU",sep=""))
dev.off()
}
OTU <- read.table(paste(files.path,'OTU_best5p/OTUp_females_35.4_best5p.txt',sep=''),header=T,sep="\t")
m <- upper.tri(as.matrix(OTU[2:ncol(OTU)]))
up <- OTU[2:ncol(OTU)][m]
hist(up)
d <- density(up)
plot(d, main="Kernel Density")
polygon(d, col="red", border="blue")
#boxplot(up,pch=20)
max(up)
min(up)
up_x <- sort(up)
hist(up_x)
up_x <- sort(up)
up_x <- up_x[min( which ( up_x != 0 )) : max( which( up_x != 0 ))]
hist(up_x)
length(up_x)
pdf("Best5p_hisCosineDistance_Male.pdf",sep=""), pointsize = 12, width = 10 , height = 7 )
hist(up_x,xlab='Cosine Distance',main="Males cosine distance distribution (2242 links)")
dev.off()
pdf("Best5p_hisCosineDistance_Male.pdf", pointsize = 12, width = 10 , height = 7 )
hist(up_x,xlab='Cosine Distance',main="Males cosine distance distribution (2242 links)")
dev.off()
OTUm <- read.table(paste(files.path,'OTU_best5p/OTUp_males_35.4_best5p.txt',sep=''),header=T,sep="\t")
OTUf <- read.table(paste(files.path,'OTU_best5p/OTUp_females_35.4_best5p.txt',sep=''),header=T,sep="\t")
OTUf <- read.table(paste(files.path,'OTU_best5p/OTUp_females_35.4_best5p.txt',sep=''),header=T,sep="\t")
OTUm <- read.table(paste(files.path,'OTU_best5p/OTUp_males_35.2_best5p.txt',sep=''),header=T,sep="\t")
OTU <- OTUm
m <- upper.tri(as.matrix(OTU[2:ncol(OTU)]))
up <- OTU[2:ncol(OTU)][m]
up_x <- sort(up)
up_x <- up_x[min( which ( up_x != 0 )) : max( which( up_x != 0 ))]
pdf("Best5p_hisCosineDistance_Male_35-2.pdf", pointsize = 12, width = 10 , height = 7 )
hist(up_x,xlab='Cosine Distance',main="Males cosine distance distribution (2242 links) window age = 35.2")
dev.off()
OTU <- OTUf
m <- upper.tri(as.matrix(OTU[2:ncol(OTU)]))
up <- OTU[2:ncol(OTU)][m]
up_x <- sort(up)
up_x <- up_x[min( which ( up_x != 0 )) : max( which( up_x != 0 ))]
pdf("Best5p_hisCosineDistance_Female_35-4.pdf", pointsize = 12, width = 10 , height = 7 )
hist(up_x,xlab='Cosine Distance',main="Females cosine distance distribution (2242 links) window age = 35.4")
dev.off()
df <- f_wdeg
sample <- "Females"
z = data.frame("X"=NULL,"N"=NULL,"P"=NULL,"V"=NULL)
for (i in seq(1,ncol(t(df)))){
x = t(df[i,])
f <- sort(x[2:length(x)],decreasing=T)[1]
fn <- rownames(x)[which(x %in% f)[1]]
s <- sort(x[2:length(x)],decreasing=T)[2]
sn <- rownames(x)[which(x %in% s)[1]]
t <- sort(x[2:length(x)],decreasing=T)[3]
tn <- rownames(x)[which(x %in% t)[1]]
l <- sort(x[2:length(x)],decreasing=F)
l <- l[min( which ( l != 0 )) : max( which( l != 0 ))][1]
ln <- rownames(x)[match(x[grep(l,x)],x)][1]
k = data.frame("X"=rep(x[1],4),"N"=c(fn,sn,tn,ln),"P"=c("F","S","T","L"),"V"=c(f,s,t,l))
z <- rbind(z,k)
}
maxS <- sort(z$V[z$P=="F"],decreasing=T)[1]
maxS <- which(z$V %in% maxS)[1]
z[maxS,1]
minS <- sort(z$V[z$P=="F"],decreasing=F)[1]
maxS <- which(z$V %in% minS)[1]
z[minS,1]
m <- melt(df,id.vars=c("X"))
pdf(paste("Best5p_TopOTUstrength",sample,".pdf",sep=""), pointsize = 12, width = 10 , height = 7 )
ggplot(data=m)+geom_line(aes(x=z$X,y=z$V,group=z$P,colour=z$P))+geom_point(aes(x=z$X,y=z$V,colour=z$P),size=1.5)+
ylab("Strength")+xlab("Window age mean")+ggtitle(paste(sample," - OTU with highest strength",sep=""))+#scale_y_discrete(labels="")+
scale_colour_discrete(name="Positions",breaks=c("F", "S","T", "L"),labels=c("First","Second","Thirth","Last"))
dev.off()
pdf(paste("Best5p_AllOTUstrength",sample,".pdf",sep=""), pointsize = 12, width = 10 , height = 7 )
ggplot(data=m,aes(x=X,y=value,group=variable,colour=variable))+geom_line()+geom_point(size=1.5)+
ylab("Strength")+xlab("Window age mean")+theme(legend.position="none")+ggtitle(paste(sample," - Strength by OTU",sep=""))
dev.off()
df <- w_wdeg
sample <- "Males"
df <- w_wdeg
m_wdeg <- read.table(paste(files.path,'OTU_best5p/OTUp_males_best5p_wdegree_st.txt',sep=''),header=T,sep="\t")
df <- w_wdeg
df <- m_wdeg
sample <- "Males"
z = data.frame("X"=NULL,"N"=NULL,"P"=NULL,"V"=NULL)
for (i in seq(1,ncol(t(df)))){
x = t(df[i,])
f <- sort(x[2:length(x)],decreasing=T)[1]
fn <- rownames(x)[which(x %in% f)[1]]
s <- sort(x[2:length(x)],decreasing=T)[2]
sn <- rownames(x)[which(x %in% s)[1]]
t <- sort(x[2:length(x)],decreasing=T)[3]
tn <- rownames(x)[which(x %in% t)[1]]
l <- sort(x[2:length(x)],decreasing=F)
l <- l[min( which ( l != 0 )) : max( which( l != 0 ))][1]
ln <- rownames(x)[match(x[grep(l,x)],x)][1]
k = data.frame("X"=rep(x[1],4),"N"=c(fn,sn,tn,ln),"P"=c("F","S","T","L"),"V"=c(f,s,t,l))
z <- rbind(z,k)
}
maxS <- sort(z$V[z$P=="F"],decreasing=T)[1]
maxS <- which(z$V %in% maxS)[1]
z[maxS,1]
minS <- sort(z$V[z$P=="F"],decreasing=F)[1]
maxS <- which(z$V %in% minS)[1]
z[minS,1]
m <- melt(df,id.vars=c("X"))
pdf(paste("Best5p_TopOTUstrength",sample,".pdf",sep=""), pointsize = 12, width = 10 , height = 7 )
ggplot(data=m)+geom_line(aes(x=z$X,y=z$V,group=z$P,colour=z$P))+geom_point(aes(x=z$X,y=z$V,colour=z$P),size=1.5)+
ylab("Strength")+xlab("Window age mean")+ggtitle(paste(sample," - OTU with highest strength",sep=""))+#scale_y_discrete(labels="")+
scale_colour_discrete(name="Positions",breaks=c("F", "S","T", "L"),labels=c("First","Second","Thirth","Last"))
dev.off()
pdf(paste("Best5p_AllOTUstrength",sample,".pdf",sep=""), pointsize = 12, width = 10 , height = 7 )
ggplot(data=m,aes(x=X,y=value,group=variable,colour=variable))+geom_line()+geom_point(size=1.5)+
ylab("Strength")+xlab("Window age mean")+theme(legend.position="none")+ggtitle(paste(sample," - Strength by OTU",sep=""))
dev.off()
df <- m_wdeg
sample <- "Males"
head(wdSE)
wdSE
colnames(wdSE)
head(wdSE)
colnames(wdSE) <- c("WinAge","NumOTUs","aveStrength","stdDev","stdError","ConfInterv","Gender")
head(wdSE)
write.table(wdSE,file="Strength_Stats")
write.table(wdSE,file="Best5p_strength_Stats.txt",sep="\t")
write.table(wdSE,file="Best5p_strength_Stats.txt",sep="\t",row.names=FALSE)
